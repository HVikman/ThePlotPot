"use strict";(self.webpackChunktheplotpot_frontend=self.webpackChunktheplotpot_frontend||[]).push([[873],{8547:(e,t,a)=>{a.d(t,{A:()=>b});a(5043);var r=a(4990),n=a(6269),c=a(661),s=a(6896),i=a(9351),o=a(6727),l=a(3442),d=a(5830),h=a(7039),u=a(928),g=a(8389),v=a(6210),x=a(8576),m=a(4313),p=a(1683),A=a(4857),j=a(3461),y=a(579);const b=e=>{let{content:t,onUpdate:a,characterLimit:b=12e3}=e;const C=(0,r.hG)({extensions:[n.A,c.A.configure({levels:[1,2,3]}),s.Ay,i.Ay,o.A,l.Ay,d.Ay,h.Ay,u.A.configure({limit:b})],content:t,onUpdate:e=>{let{editor:t}=e;a&&a(t.getHTML())}});return C?(0,y.jsxs)("div",{className:"rich-text-editor",children:[(0,y.jsxs)("div",{className:"editor-toolbar",children:[(0,y.jsx)("button",{onClick:()=>C.chain().focus().toggleBold().run(),className:C.isActive("bold")?"active":"",children:(0,y.jsx)(g.A,{})}),(0,y.jsx)("button",{onClick:()=>C.chain().focus().toggleItalic().run(),className:C.isActive("italic")?"active":"",children:(0,y.jsx)(v.A,{})}),(0,y.jsx)("button",{onClick:()=>C.chain().focus().toggleUnderline().run(),className:C.isActive("underline")?"active":"",children:(0,y.jsx)(x.A,{})}),(0,y.jsxs)("button",{onClick:()=>C.chain().focus().toggleHeading({level:1}).run(),className:C.isActive("heading",{level:1})?"active":"",children:[(0,y.jsx)(m.A,{})," H1"]}),(0,y.jsxs)("button",{onClick:()=>C.chain().focus().toggleHeading({level:2}).run(),className:C.isActive("heading",{level:2})?"active":"",children:[(0,y.jsx)(m.A,{})," H2"]}),(0,y.jsxs)("button",{onClick:()=>C.chain().focus().toggleHeading({level:3}).run(),className:C.isActive("heading",{level:3})?"active":"",children:[(0,y.jsx)(m.A,{})," H3"]}),(0,y.jsx)("button",{onClick:()=>C.chain().focus().toggleBulletList().run(),className:C.isActive("bulletList")?"active":"",children:(0,y.jsx)(p.A,{})}),(0,y.jsx)("button",{onClick:()=>C.chain().focus().toggleOrderedList().run(),className:C.isActive("orderedList")?"active":"",children:(0,y.jsx)(A.A,{})}),(0,y.jsx)("button",{onClick:()=>C.chain().focus().toggleBlockquote().run(),className:C.isActive("blockquote")?"active":"",children:(0,y.jsx)(j.A,{})})]}),(0,y.jsx)("div",{children:(0,y.jsx)(r.$Z,{editor:C,"data-placeholder":"Start typing here...",className:"editor-content"})}),(0,y.jsxs)("div",{className:"character-count",children:[C.storage.characterCount.characters(),"/",b," characters"]})]}):null}},5873:(e,t,a)=>{a.r(t),a.d(t,{default:()=>A});var r=a(2134),n=a(3516),c=a(899),s=a(6216),i=a(6311),o=a(4282),l=a(8547),d=a(1881),h=a(4743);var u=a(2915),g=a(6290),v=(a(4838),a(579));const x=12e3,m=c.Ik({title:c.Yj().required("Required").max(100,"Must be 100 characters or less"),content:c.Yj().required("Required").max(x,"Content must be ".concat(x," characters or less"))}),p={title:"",content:"",honeypot:""},A=()=>{const{isDarkMode:e}=(0,g.D2)(),t=(0,r.zy)(),{storyId:a,parentChapter:c,navigationStack:A}=t.state,{addNotification:j}=(0,u.E)(),[y]=((e,t,a,n)=>{const c=(0,r.Zp)(),[s,{error:i}]=(0,d.n)(h.xT,{update:(r,s)=>{let{data:{createChapter:o}}=s;try{const{getStory:s}=r.readQuery({query:h.Vm,variables:{id:e}}),i=[...s.chapters,o];r.writeQuery({query:h.Vm,variables:{id:e},data:{getStory:{...s,chapters:i}}});const{getChapterChildren:l}=r.readQuery({query:h.VE,variables:{id:t.id}}),d=[...l,o];r.writeQuery({query:h.VE,variables:{id:t.id},data:{getChapterChildren:d}}),n("".concat(o.title," created successfully!"),2e3,"success"),console.log(o),c("/story/".concat(e),{state:{chapter:o,navigationStack:[...a,t]}})}catch(i){console.error("Error updating cache after adding chapter:",i),n(i.message,2e3,"error")}}});return[s,i]})(a,c,A,j),b=(0,n.Wx)({initialValues:p,validationSchema:m,onSubmit:e=>{e.honeypot?console.log("Bot detected"):y({variables:{storyId:a,parentChapterId:c.id,branch:c.branch+1,title:e.title,content:e.content}}).catch((e=>{console.error("There was an error creating the chapter:",e),j(e.message,3e3,"error")}))}});return(0,v.jsxs)("div",{className:"add-chapter-container mx-4",children:[(0,v.jsx)("h2",{children:"Add a New Chapter"}),(0,v.jsxs)(s.A,{onSubmit:b.handleSubmit,className:"".concat(e?"dark-mode":"light-mode"),children:[(0,v.jsxs)(s.A.Group,{controlId:"formTitle",children:[(0,v.jsx)(s.A.Label,{children:"Title"}),(0,v.jsx)(i.A,{type:"text",placeholder:"Give your story a cool title",name:"title",onChange:b.handleChange,onBlur:b.handleBlur,value:b.values.title}),(0,v.jsxs)("div",{className:"character-counter ".concat(b.values.title.length>80?"warning":""),children:[b.values.title.length,"/100 characters"]}),b.touched.title&&b.errors.title&&(0,v.jsx)(s.A.Text,{className:"text-danger",children:b.errors.title})]}),(0,v.jsx)(s.A.Group,{controlId:"formHoneypot",children:(0,v.jsx)(i.A,{type:"text",name:"honeypot",onChange:b.handleChange,onBlur:b.handleBlur,value:b.values.honeypot,style:{display:"none"}})}),(0,v.jsxs)(s.A.Group,{controlId:"formContent",children:[(0,v.jsx)(s.A.Label,{children:"Content"}),(0,v.jsx)(l.A,{content:b.values.content,onUpdate:e=>{b.setFieldValue("content",e)},characterLimit:x}),b.touched.content&&b.errors.content&&(0,v.jsx)(s.A.Text,{className:"text-danger",children:b.errors.content})]}),(0,v.jsx)(o.A,{variant:"secondary",type:"submit",children:"Submit"})]})]})}},4838:()=>{}}]);
//# sourceMappingURL=873.6906dbc0.chunk.js.map