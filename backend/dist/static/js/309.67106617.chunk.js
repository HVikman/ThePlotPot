"use strict";(self.webpackChunktheplotpot_frontend=self.webpackChunktheplotpot_frontend||[]).push([[309],{2309:(e,t,r)=>{r.r(t),r.d(t,{default:()=>f});var a=r(2791),i=r(2506),o=r(8007),l=r(5057),n=r(5875),s=r(35),c=r(1610),u=r(3360);const h=["Action and Adventure","Adventure","Alternate History","Anthology","Art","Autobiography","Biography","Childrens","Classic","Comic/Graphic Novel","Contemporary","Crime","Drama","Dystopian","Epic","Erotic Fiction","Fable","Fairy Tale","Fantasy","Gothic Fiction","Historical Fiction","Horror","Humor","Inspirational","Journal","LGBT","Literary Fiction","Military/War Fiction","Mystery","Mythology","Noir","Paranormal Romance","Philosophical","Poetry","Political","Post-Apocalyptic","Psychological Thriller","Religious","Romance","Satire","Science Fiction","Self-help","Short Story","Speculative Fiction","Spiritual","Sports","Suspense/Thriller","Travel","True Crime","Western","Young Adult (YA)"];var d=r(6770),p=r.n(d),y=(r(215),r(1684),r(8281),r(3812)),g=r(8261),m=r(4376),v=r(9829),x=r(7689);var C=r(184);const b=o.Ry({title:o.Z_().required("Required").max(100,"Must be 100 characters or less"),description:o.Z_().required("Required").max(500,"Must be 450 characters or less"),content:o.Z_().required("Required"),genre:o.Z_().required("Required")}),S={title:"",description:"",content:"",genre:"",honeypot:""},A={characterCounter:{container:"#character-count",maxChars:12e3},toolbar:[[{header:[1,2,3,!1]}],["bold","italic","underline","blockquote"],[{list:"ordered"},{list:"bullet"}]]},f=()=>{const{addNotification:e}=(0,g.z)(),{user:t}=(0,y.a)(),r=!!t,[o,d]=(0,a.useState)("disabled"),f=(e=>{const t=(0,x.s0)(),[r]=(0,m.D)(v.pk,{update:(r,a)=>{let{data:{createStory:i}}=a;i.success?(e("".concat(i.story.title," created successfully!"),2e3,"success"),console.log("New Story ID:",i.story.id),t("/story/".concat(i.story.id))):(console.log("Failed to create story:",i.message),e("Story creation failed: ".concat(i.message),2e3,"error"));const{getAllStories:o}=r.readQuery({query:v.Dz}),l=[...o,i.story];r.writeQuery({query:v.Dz,data:{getAllStories:l}})}});return r})(e),j=(0,i.TA)({initialValues:S,validationSchema:b,onSubmit:t=>{t.honeypot?console.log("Bot detected"):grecaptcha.ready((async()=>{const r=await grecaptcha.execute("6LfY0fooAAAAAKaljIbo723ZiMGApMCVg6ZU805o",{action:"submit"});f({variables:{title:t.title,description:t.description,genre:t.genre,firstChapterContent:t.content,token:r}}).catch((t=>{console.error("There was an error creating the chapter:",t),e(t.message,3e3,"error")}))}))}});if((0,a.useEffect)((()=>{j.values.title&&j.values.description&&j.values.genre?d(""):d("disabled")}),[j.values.title,j.values.description,j.values.genre]),!r)return(0,C.jsx)("p",{children:"You are not logged in."});const q=[{key:"1",label:"Step 1: Basic Details",children:(0,C.jsxs)(l.Z,{layout:"vertical",onSubmit:j.handleSubmit,className:"mx-2",children:[(0,C.jsx)(l.Z.Item,{label:"Title",help:j.touched.title&&j.errors.title,children:(0,C.jsx)(n.Z,{type:"text",name:"title",placeholder:"Give your story a cool title",onChange:j.handleChange,onBlur:j.handleBlur,value:j.values.title})}),(0,C.jsx)(l.Z.Item,{label:"Description",help:j.touched.description&&j.errors.description,children:(0,C.jsx)(n.Z.TextArea,{name:"description",placeholder:"Captivating description goes here!",onChange:j.handleChange,onBlur:j.handleBlur,value:j.values.description,rows:4})}),(0,C.jsx)(l.Z.Item,{style:{display:"none"},children:(0,C.jsx)(n.Z,{type:"text",name:"honeypot",onChange:j.handleChange,onBlur:j.handleBlur,value:j.values.honeypot})}),(0,C.jsx)(l.Z.Item,{label:"Genre",help:j.touched.genre&&j.errors.genre,children:(0,C.jsx)(s.Z,{value:j.values.genre,onChange:e=>j.setFieldValue("genre",e),style:{width:"100%"},options:h.map((e=>({value:e}))),placeholder:"Select a genre",filterOption:(e,t)=>t.value.toUpperCase().includes(e.toUpperCase())})})]})},{key:"2",collapsible:o,label:"Step 2: Story Content",children:(0,C.jsxs)("div",{className:"mx-2",children:[(0,C.jsx)(p(),{value:j.values.content,onChange:e=>j.setFieldValue("content",e),theme:"snow",modules:A}),(0,C.jsx)("div",{id:"character-count"}),(0,C.jsx)(u.Z,{variant:"secondary",onClick:()=>j.handleSubmit(),children:"Submit"})]})}];return(0,C.jsx)(c.default,{items:q,defaultActiveKey:["1"]})}},1684:(e,t,r)=>{var a=r(6921),i=r.n(a);class o{constructor(e,t){this.quill=e,this.options=t,this.container=document.querySelector(t.container),e.on("text-change",this.update.bind(this)),this.update()}calculate(){return this.quill.getText().length}update(){let e=this.calculate();if(e>this.options.maxChars){let e=this.quill.getText().substring(0,this.options.maxChars);this.quill.setText(e)}this.container.innerText=e+" / "+this.options.maxChars}}i().register("modules/characterCounter",o)},8281:()=>{}}]);
//# sourceMappingURL=309.67106617.chunk.js.map