"use strict";(self.webpackChunktheplotpot_frontend=self.webpackChunktheplotpot_frontend||[]).push([[702],{8702:(e,t,r)=>{r.r(t),r.d(t,{default:()=>j});var i=r(5043),o=r(3516),a=r(899),l=r(8782),n=r(2615),s=r(5800),c=r(2359),u=r(4282);const h=["Action and Adventure","Adventure","Alternate History","Anthology","Art","Autobiography","Biography","Childrens","Classic","Comic/Graphic Novel","Contemporary","Crime","Drama","Dystopian","Epic","Erotic Fiction","Fable","Fairy Tale","Fantasy","Gothic Fiction","Historical Fiction","Horror","Humor","Inspirational","Journal","LGBT","Literary Fiction","Military/War Fiction","Mystery","Mythology","Noir","Paranormal Romance","Philosophical","Poetry","Political","Post-Apocalyptic","Psychological Thriller","Religious","Romance","Satire","Science Fiction","Self-help","Short Story","Speculative Fiction","Spiritual","Sports","Suspense/Thriller","Travel","True Crime","Western","Young Adult (YA)"];var d=r(2823),p=r.n(d),y=(r(7590),r(1393),r(583),r(2855)),g=r(1898),m=r(1881),v=r(4743),x=r(3216);var A=r(579);const C=a.Ik({title:a.Yj().required("Required").max(100,"Must be 100 characters or less"),description:a.Yj().required("Required").max(500,"Must be 450 characters or less"),content:a.Yj().required("Required"),genre:a.Yj().required("Required")}),b={title:"",description:"",content:"",genre:"",honeypot:""},S={characterCounter:{container:"#character-count",maxChars:12e3},toolbar:[[{header:[1,2,3,!1]}],["bold","italic","underline","blockquote"],[{list:"ordered"},{list:"bullet"}]]},j=()=>{const{addNotification:e}=(0,g.E)(),{user:t}=(0,y.A)(),r=!!t,[a,d]=(0,i.useState)("disabled"),j=(e=>{const t=(0,x.Zp)(),[r]=(0,m.n)(v.dj,{update:(r,i)=>{let{data:{createStory:o}}=i;o.success?(e("".concat(o.story.title," created successfully!"),2e3,"success"),console.log("New Story ID:",o.story.id),t("/story/".concat(o.story.id))):(console.log("Failed to create story:",o.message),e("Story creation failed: ".concat(o.message),2e3,"error"));const{getAllStories:a}=r.readQuery({query:v.F4}),l=[...a,o.story];r.writeQuery({query:v.F4,data:{getAllStories:l}})}});return r})(e),f=(0,o.Wx)({initialValues:b,validationSchema:C,onSubmit:t=>{t.honeypot?console.log("Bot detected"):grecaptcha.ready((async()=>{const r=await grecaptcha.execute("6LfY0fooAAAAAKaljIbo723ZiMGApMCVg6ZU805o",{action:"submit"});j({variables:{title:t.title,description:t.description,genre:t.genre,firstChapterContent:t.content,token:r}}).catch((t=>{console.error("There was an error creating the chapter:",t),e(t.message,3e3,"error")}))}))}});if((0,i.useEffect)((()=>{f.values.title&&f.values.description&&f.values.genre?d(""):d("disabled")}),[f.values.title,f.values.description,f.values.genre]),!r)return(0,A.jsx)("p",{children:"You are not logged in."});const q=[{key:"1",label:"Step 1: Basic Details",children:(0,A.jsxs)(l.A,{layout:"vertical",onSubmit:f.handleSubmit,className:"mx-2",children:[(0,A.jsx)(l.A.Item,{label:"Title",help:f.touched.title&&f.errors.title,children:(0,A.jsx)(n.A,{type:"text",name:"title",placeholder:"Give your story a cool title",onChange:f.handleChange,onBlur:f.handleBlur,value:f.values.title})}),(0,A.jsx)(l.A.Item,{label:"Description",help:f.touched.description&&f.errors.description,children:(0,A.jsx)(n.A.TextArea,{name:"description",placeholder:"Captivating description goes here!",onChange:f.handleChange,onBlur:f.handleBlur,value:f.values.description,rows:4})}),(0,A.jsx)(l.A.Item,{style:{display:"none"},children:(0,A.jsx)(n.A,{type:"text",name:"honeypot",onChange:f.handleChange,onBlur:f.handleBlur,value:f.values.honeypot})}),(0,A.jsx)(l.A.Item,{label:"Genre",help:f.touched.genre&&f.errors.genre,children:(0,A.jsx)(s.A,{value:f.values.genre,onChange:e=>f.setFieldValue("genre",e),style:{width:"100%"},options:h.map((e=>({value:e}))),placeholder:"Select a genre",filterOption:(e,t)=>t.value.toUpperCase().includes(e.toUpperCase())})})]})},{key:"2",collapsible:a,label:"Step 2: Story Content",children:(0,A.jsxs)("div",{className:"mx-2",children:[(0,A.jsx)(p(),{value:f.values.content,onChange:e=>f.setFieldValue("content",e),theme:"snow",modules:S}),(0,A.jsx)("div",{id:"character-count"}),(0,A.jsx)(u.A,{variant:"secondary",onClick:()=>f.handleSubmit(),children:"Submit"})]})}];return(0,A.jsx)(c.A,{items:q,defaultActiveKey:["1"]})}},1393:(e,t,r)=>{var i=r(4175),o=r.n(i);class a{constructor(e,t){this.quill=e,this.options=t,this.container=document.querySelector(t.container),e.on("text-change",this.update.bind(this)),this.update()}calculate(){return this.quill.getText().length}update(){let e=this.calculate();if(e>this.options.maxChars){let e=this.quill.getText().substring(0,this.options.maxChars);this.quill.setText(e)}this.container.innerText=e+" / "+this.options.maxChars}}o().register("modules/characterCounter",a)},583:()=>{}}]);
//# sourceMappingURL=702.61341148.chunk.js.map