"use strict";(self.webpackChunktheplotpot_frontend=self.webpackChunktheplotpot_frontend||[]).push([[821],{821:function(e,t,n){n.r(t),n.d(t,{default:function(){return te}});var o=n(9439),r=n(7689),a=n(5705),c=n(8007),i=n(6714),l=n(2298),s=n(4942),d=n(7557),u=n(2621),p=n(732),m=n(187),h=n(3844),g=n(1694),f=n.n(g),v=n(8568),b=n(4170),y=n(2791),Z=n(1113),C=n(1929),x=n(7521),S=n(5564),E=n(9922),I=function(e,t,n,o,r){return(0,s.Z)({backgroundColor:e,border:"".concat(o.lineWidth,"px ").concat(o.lineType," ").concat(t)},"".concat(r,"-icon"),{color:n})},k=function(e){var t,n,o,r=e.componentCls,a=e.motionDurationSlow,c=e.marginXS,i=e.marginSM,l=e.fontSize,d=e.fontSizeLG,u=e.lineHeight,p=e.borderRadiusLG,m=e.motionEaseInOutCirc,h=e.alertIconSizeLG,g=e.colorText,f=e.paddingContentVerticalSM,v=e.alertPaddingHorizontal,b=e.paddingMD,y=e.paddingContentHorizontalLG,Z=e.colorTextHeading;return o={},(0,s.Z)(o,r,Object.assign(Object.assign({},(0,x.Wf)(e)),(t={position:"relative",display:"flex",alignItems:"center",padding:"".concat(f,"px ").concat(v,"px"),wordWrap:"break-word",borderRadius:p},(0,s.Z)(t,"&".concat(r,"-rtl"),{direction:"rtl"}),(0,s.Z)(t,"".concat(r,"-content"),{flex:1,minWidth:0}),(0,s.Z)(t,"".concat(r,"-icon"),{marginInlineEnd:c,lineHeight:0}),(0,s.Z)(t,"&-description",{display:"none",fontSize:l,lineHeight:u}),(0,s.Z)(t,"&-message",{color:g}),(0,s.Z)(t,"&".concat(r,"-motion-leave"),{overflow:"hidden",opacity:1,transition:"max-height ".concat(a," ").concat(m,", opacity ").concat(a," ").concat(m,",\n        padding-top ").concat(a," ").concat(m,", padding-bottom ").concat(a," ").concat(m,",\n        margin-bottom ").concat(a," ").concat(m)}),(0,s.Z)(t,"&".concat(r,"-motion-leave-active"),{maxHeight:0,marginBottom:"0 !important",paddingTop:0,paddingBottom:0,opacity:0}),t))),(0,s.Z)(o,"".concat(r,"-with-description"),(n={alignItems:"flex-start",paddingInline:y,paddingBlock:b},(0,s.Z)(n,"".concat(r,"-icon"),{marginInlineEnd:i,fontSize:h,lineHeight:0}),(0,s.Z)(n,"".concat(r,"-message"),{display:"block",marginBottom:c,color:Z,fontSize:d}),(0,s.Z)(n,"".concat(r,"-description"),{display:"block"}),n)),(0,s.Z)(o,"".concat(r,"-banner"),{marginBottom:0,border:"0 !important",borderRadius:0}),o},w=function(e){var t=e.componentCls,n=e.colorSuccess,o=e.colorSuccessBorder,r=e.colorSuccessBg,a=e.colorWarning,c=e.colorWarningBorder,i=e.colorWarningBg,l=e.colorError,d=e.colorErrorBorder,u=e.colorErrorBg,p=e.colorInfo,m=e.colorInfoBorder,h=e.colorInfoBg;return(0,s.Z)({},t,{"&-success":I(r,o,n,e,t),"&-info":I(h,m,p,e,t),"&-warning":I(i,c,a,e,t),"&-error":Object.assign(Object.assign({},I(u,d,l,e,t)),(0,s.Z)({},"".concat(t,"-description > pre"),{margin:0,padding:0}))})},N=function(e){var t,n=e.componentCls,o=e.iconCls,r=e.motionDurationMid,a=e.marginXS,c=e.fontSizeIcon,i=e.colorIcon,l=e.colorIconHover;return(0,s.Z)({},n,(t={},(0,s.Z)(t,"&-action",{marginInlineStart:a}),(0,s.Z)(t,"".concat(n,"-close-icon"),(0,s.Z)({marginInlineStart:a,padding:0,overflow:"hidden",fontSize:c,lineHeight:"".concat(c,"px"),backgroundColor:"transparent",border:"none",outline:"none",cursor:"pointer"},"".concat(o,"-close"),{color:i,transition:"color ".concat(r),"&:hover":{color:l}})),(0,s.Z)(t,"&-close-text",{color:i,transition:"color ".concat(r),"&:hover":{color:l}}),t))},j=function(e){return[k(e),w(e),N(e)]},O=(0,S.Z)("Alert",(function(e){var t=e.fontSizeHeading3,n=(0,E.TS)(e,{alertIconSizeLG:t,alertPaddingHorizontal:12});return[j(n)]})),B=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]])}return n},z={success:d.Z,info:h.Z,error:u.Z,warning:m.Z},H=function(e){var t=e.icon,n=e.prefixCls,o=e.type,r=z[o]||null;return t?(0,Z.wm)(t,y.createElement("span",{className:"".concat(n,"-icon")},t),(function(){return{className:f()("".concat(n,"-icon"),(0,s.Z)({},t.props.className,t.props.className))}})):y.createElement(r,{className:"".concat(n,"-icon")})},T=function(e){var t=e.isClosable,n=e.prefixCls,o=e.closeIcon,r=e.handleClose,a=!0===o||void 0===o?y.createElement(p.Z,null):o;return t?y.createElement("button",{type:"button",onClick:r,className:"".concat(n,"-close-icon"),tabIndex:0},a):null};var q=function(e){var t,n=e.description,r=e.prefixCls,a=e.message,c=e.banner,i=e.className,l=e.rootClassName,d=e.style,u=e.onMouseEnter,p=e.onMouseLeave,m=e.onClick,h=e.afterClose,g=e.showIcon,Z=e.closable,x=e.closeText,S=e.closeIcon,E=e.action,I=B(e,["description","prefixCls","message","banner","className","rootClassName","style","onMouseEnter","onMouseLeave","onClick","afterClose","showIcon","closable","closeText","closeIcon","action"]),k=y.useState(!1),w=(0,o.Z)(k,2),N=w[0],j=w[1];var z=y.useRef(null),q=y.useContext(C.E_),M=q.getPrefixCls,L=q.direction,P=q.alert,R=M("alert",r),W=O(R),D=(0,o.Z)(W,2),G=D[0],X=D[1],_=function(t){var n;j(!0),null===(n=e.onClose)||void 0===n||n.call(e,t)},A=y.useMemo((function(){return void 0!==e.type?e.type:c?"warning":"info"}),[e.type,c]),Q=y.useMemo((function(){return!!x||("boolean"===typeof Z?Z:!1!==S&&null!==S&&void 0!==S)}),[x,S,Z]),V=!(!c||void 0!==g)||g,$=f()(R,"".concat(R,"-").concat(A),(t={},(0,s.Z)(t,"".concat(R,"-with-description"),!!n),(0,s.Z)(t,"".concat(R,"-no-icon"),!V),(0,s.Z)(t,"".concat(R,"-banner"),!!c),(0,s.Z)(t,"".concat(R,"-rtl"),"rtl"===L),t),null===P||void 0===P?void 0:P.className,i,l,X),F=(0,b.Z)(I,{aria:!0,data:!0});return G(y.createElement(v.ZP,{visible:!N,motionName:"".concat(R,"-motion"),motionAppear:!1,motionEnter:!1,onLeaveStart:function(e){return{maxHeight:e.offsetHeight}},onLeaveEnd:h},(function(t){var o=t.className,r=t.style;return y.createElement("div",Object.assign({ref:z,"data-show":!N,className:f()($,o),style:Object.assign(Object.assign(Object.assign({},null===P||void 0===P?void 0:P.style),d),r),onMouseEnter:u,onMouseLeave:p,onClick:m,role:"alert"},F),V?y.createElement(H,{description:n,icon:e.icon,prefixCls:R,type:A}):null,y.createElement("div",{className:"".concat(R,"-content")},a?y.createElement("div",{className:"".concat(R,"-message")},a):null,n?y.createElement("div",{className:"".concat(R,"-description")},n):null),E?y.createElement("div",{className:"".concat(R,"-action")},E):null,y.createElement(T,{isClosable:Q,prefixCls:R,closeIcon:x||S,handleClose:_}))})))},M=n(5671),L=n(3144),P=n(136),R=n(7277),W=function(e){(0,P.Z)(n,e);var t=(0,R.Z)(n);function n(){var e;return(0,M.Z)(this,n),(e=t.apply(this,arguments)).state={error:void 0,info:{componentStack:""}},e}return(0,L.Z)(n,[{key:"componentDidCatch",value:function(e,t){this.setState({error:e,info:t})}},{key:"render",value:function(){var e=this.props,t=e.message,n=e.description,o=e.children,r=this.state,a=r.error,c=r.info,i=c&&c.componentStack?c.componentStack:null,l="undefined"===typeof t?(a||"").toString():t,s="undefined"===typeof n?i:n;return a?y.createElement(q,{type:"error",message:l,description:y.createElement("pre",{style:{fontSize:"0.9em",overflowX:"auto"}},s)}):o}}]),n}(y.Component),D=W,G=q;G.ErrorBoundary=D;var X=G,_=n(3360),A=n(6770),Q=n.n(A),V=(n(215),n(1684),n(1413)),$=n(3433),F=n(4376),J=n(9829),K=n(8261),U=(n(8281),n(184)),Y=c.Ry({title:c.Z_().required("Required").max(100,"Must be 100 characters or less"),content:c.Z_().required("Required")}),ee={title:"",content:"",honeypot:""},te=function(){var e=(0,r.TH)().state,t=e.storyId,n=e.parentChapter,c=e.navigationStack,s=(0,K.z)().addNotification,d=function(e,t,n,a){var c=(0,r.s0)(),i=(0,F.D)(J.c$,{update:function(o,r){var i=r.data.createChapter;try{var l=o.readQuery({query:J.$X,variables:{id:e}}).getStory,s=[].concat((0,$.Z)(l.chapters),[i]);o.writeQuery({query:J.$X,variables:{id:e},data:{getStory:(0,V.Z)((0,V.Z)({},l),{},{chapters:s})}});var d=o.readQuery({query:J.SN,variables:{id:t.id}}).getChapterChildren,u=[].concat((0,$.Z)(d),[i]);o.writeQuery({query:J.SN,variables:{id:t.id},data:{getChapterChildren:u}}),a("".concat(i.title," created successfully!"),2e3,"success"),console.log(i),c("/story/".concat(e),{state:{chapter:i,navigationStack:[].concat((0,$.Z)(n),[t])}})}catch(m){console.error("Error updating cache after adding chapter:",m),a(m.message,2e3,"error")}}}),l=(0,o.Z)(i,2);return[l[0],l[1].error]}(t,n,c,s),u=(0,o.Z)(d,2),p=u[0],m=u[1],h=(0,a.TA)({initialValues:ee,validationSchema:Y,onSubmit:function(e){e.honeypot?console.log("Bot detected"):p({variables:{storyId:t,parentChapterId:n.id,branch:n.branch+1,title:e.title,content:e.content}}).catch((function(e){console.error("There was an error creating the chapter:",e),s(e.message,3e3,"error")}))}});return(0,U.jsxs)("div",{className:"add-chapter-container mx-4",children:[(0,U.jsx)("h2",{children:"Add a New Chapter"}),(0,U.jsxs)(i.Z,{layout:"vertical",onSubmit:h.handleSubmit,children:[(0,U.jsx)(i.Z.Item,{label:"Title",help:h.touched.title&&h.errors.title,children:(0,U.jsx)(l.Z,{type:"text",name:"title",placeholder:"Chapter title",onChange:h.handleChange,onBlur:h.handleBlur,value:h.values.title})}),(0,U.jsxs)(i.Z.Item,{label:"Content",help:h.touched.content&&h.errors.content,children:[(0,U.jsx)(Q(),{value:h.values.content,placeholder:"Chapter content goes here...",onChange:function(e){return h.setFieldValue("content",e)},theme:"snow",modules:{characterCounter:{container:"#char-count",maxChars:12e3},toolbar:[[{header:[1,2,3,!1]}],["bold","italic","underline","blockquote"],[{list:"ordered"},{list:"bullet"}]]}}),(0,U.jsx)("div",{id:"char-count"})]}),(0,U.jsx)(_.Z,{variant:"secondary",onClick:function(){return h.handleSubmit()},children:"Submit"})]}),m&&(0,U.jsx)(X,{type:"error",message:m.message,className:"mt-3"})]})}},1684:function(e,t,n){var o=n(5671),r=n(3144),a=n(6921),c=n.n(a),i=function(){function e(t,n){(0,o.Z)(this,e),this.quill=t,this.options=n,this.container=document.querySelector(n.container),t.on("text-change",this.update.bind(this)),this.update()}return(0,r.Z)(e,[{key:"calculate",value:function(){return this.quill.getText().length}},{key:"update",value:function(){var e=this.calculate();if(e>this.options.maxChars){var t=this.quill.getText().substring(0,this.options.maxChars);this.quill.setText(t)}this.container.innerText=e+" / "+this.options.maxChars}}]),e}();c().register("modules/characterCounter",i)},8281:function(){}}]);
//# sourceMappingURL=821.39b00882.chunk.js.map